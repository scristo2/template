<div class="App">
    <header class="App-header">
        <div class="App-header-elements">
            <div class="App-header-buttonMenu">
                <div class="img-ButtonMenu"></div>
            </div>
            <div class="App-logo"></div>
            <div class="App-login">
                <div class="blockedImg"></div>
                <div class="loginUsername"><p class="textUsername">Log In</p></div>
            </div>
        </div>
        <div class="App-menuHidden"></div>
        <div class="App-menu">
            <p class="menu menu-border" id="barPrincipal">Principal</p>
            <p class="menu menu-border">Banned</p>
            <p class="menu menu-border">Teams</p>
            <p class="menu" id="runes">Runes</p>
        </div>
    </header>
    <div class="App-content notranslate"></div>
    <footer class="App-footer">
        <input type="button" style="color: blue;" class="App-input-file-general" value=ðŸ“‚>
        <input class="App-input-emoji" type="button" value="&#128512;"><textarea name=""  class="App-input-general" placeholder="Tell us something ...."></textarea>
        <input style="color: green;" value= â–¶ type="button"  class="App-submit-general"></footer>
    <script type="text/javascript">

       
       
       var main = function main(){

            var indexClickMenuButton = 0;
        
            function restoreUrl(){
                    
                var state = {'action' : 'Make you own team or join to any'};
                var title = "Make you own team or join to any";
                var url = "/";

                window.history.replaceState(state, title, url);

            }



              

             function clickImageLogo(){
                
                  $('.App-logo').on('click', function(){window.location.reload()});

                  //if click image and url is diferent to principal

                  if(window.location.href.includes('query')){

                         restoreUrl();
                  }
                  
                 
             }



             function autoGrowInputGeneralChat(){


                 $('.App-input-general').on('input', function(e){
                      

                     this.style.height = 'auto';
                     this.style.height = this.scrollHeight + 'px';
                     
                     $('.talkbubble-text').text(this.value);
                      
                 });
             
                

                  
             }


             function loadChatConversation(){

                  let classChatDiv = null;


                   for (let index = 0; index < 100; index++) {

       
                       if(index % 2 == 0){

                            classChatDiv = 'App-content-dialogRight';

                        }else{
          
                            classChatDiv = 'App-content-dialogLeft';
                       
                        }
    
                       $('.App-content').append("<div class='App-content-dialog " + classChatDiv + "'><div class='talkbubble'></div></div>");
       
                   }

                   let resultTime = new Date().getHours() + ':' + new Date().getMinutes();

                   let finalResultTime = resultTime;

                   $('.talkbubble').append("<div class='talkbubble-text'></div><div class='talkbubble-hour'><p>" + finalResultTime + "</p></div>");
            
                   
            }


            ///1
            function getCodeMenu(){

                  return new Promise(function(resolve, reject){

                        fetch('/src/menu/index.html?=56')
                        .then(response => {

                            if(!response.ok){

                                reject('Error when trying to open the menu');

                            }else{

                                 resolve(response.text());
                            }
                        }).catch(function(e){console.log(e)});
                  });

            }

             
            ///2
            async function openMenuAfterGetCode(){


                  var result = await getCodeMenu();
                  return result;
            }
            
            
            
            function clickMenuButton(){


                $('.img-ButtonMenu').on('click', function(){


                      if(indexClickMenuButton == 0 || $('.App-MenuDiv').length == 0 || $('.App-MenuDiv').css('display') === 'none'){
               

                          openMenuAfterGetCode().then(function(resolve){
                              
                              $('.App-menuHidden').append(resolve);
                              console.log('fetch succesfully menu');
                              
                          }, function(reject){

                               console.log(reject);

                          }).then(function(){
                               
                               //if he has already logged
                              if($('.blockedImg').css('webkit-mask-image').includes('profile')){

                                   //hidden login and register because you are logged

                                   $('.bar-logIn').css({display : 'none'});
                                   $('.bar-Register').css({display : 'none'});


                                   //show hidden bar-MyAccount

                                   $('.bar-MyAccount').css({display : 'flex'});


                              }
                          });

                          indexClickMenuButton = 1;
                          
                          $('.App-MenuDiv').remove();

                      }else{

                            ///know if open menu from other site that not be principal

                           if(window.location.href.includes('query')){

                                $('.App-MenuDiv').css({
                                    display : 'none'
                                });

                                console.log('Open menu from login');


                           }else{

                                $('.App-MenuDiv').remove();
                           }
                           
                         
                           indexClickMenuButton = 0;

                          
                      }

                });
            }



            function clickBarPrincipalButton(){

                   $('#barPrincipal').on('click', function(){

                          if(window.location.href.includes('query')){

                               loadChatConversation();
                               $('.App-contentTemporal').remove();
                               $('.App-footer').css({
                                 display : 'flex'
                               });

                               restoreUrl();
                          }

                   });
            }





            function clickLoginUsername(){




                 $('.loginUsername').on('click', function(e){

                         if($('.App-MenuDiv').css('display') === 'flex'){
                              
                               $('.bar-logIn').click();
                             
                        }else{

                             //
                        }

                 });
                         
                        
           }





             return{

                 clickImageLogo,
                 autoGrowInputGeneralChat,
                 loadChatConversation,
                 clickMenuButton,
                 clickBarPrincipalButton,
                 clickLoginUsername,
                 
             }
       }


     
       main().clickImageLogo();
       main().autoGrowInputGeneralChat();
       main().loadChatConversation();
       main().clickMenuButton();
       main().clickBarPrincipalButton();
       main().clickLoginUsername();
       

       
    </script>
</div>